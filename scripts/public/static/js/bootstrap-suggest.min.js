/**
 * bootstrap-suggest-plugin - v0.1.23
 * @description 这是一个基于 bootstrap 按钮式下拉菜单组件的搜索建议插件，必须使用于按钮式下拉菜单组件上。
 * @author [object Object]
 * @GitHub https://github.com/lzwme/bootstrap-suggest-plugin.git
 * @since 2017-12-07 10:17:28
 */

!function(e){if("function"==typeof define&&define.amd)define(["jquery"],e);else if("object"==typeof exports&&"object"==typeof module)e(require("jquery"));else{if(!window.jQuery)throw new Error("Not found jQuery.");e(window.jQuery)}}(function(e){function t(e,t){window.console&&window.console.trace}function n(e){return e.data()}function i(e,t){return void 0!==t?e.attr("alt",t):e.attr("alt")}function o(e,t){return void 0!==t?e.attr("data-id",t):e.attr("data-id")}function a(e,t,n){if(t&&t.key){var i,a,r=n.separator||",",l=o(e);n&&n.multiWord?((i=e.val().split(r))[i.length-1]=t.key,l?(a=l.split(r)).push(t.id):a=[t.id],o(e,a.join(r)).val(i.join(r)).focus()):o(e,t.id||"").val(t.key).focus(),e.data("pre-val",e.val()).trigger("onSetSelectValue",[t,(n.data.value||n._lastData.value)[t.index]])}}function r(e,t,n){if(t.is(":visible")){var i=e.parent(),o=i.height(),a=i.width();n.autoDropup&&setTimeout(function(){var n=e.offset().top,o=w.scrollTop(),a=t.height();w.height()+o-n<a&&n>a+o?i.addClass("dropup"):i.removeClass("dropup")},10);var r={};return"left"===n.listAlign?r={left:e.siblings("div").width()-a,right:"auto"}:"right"===n.listAlign&&(r={left:"auto",right:0}),x&&!n.showBtn&&(i.hasClass("dropup")?(r.top="auto",r.bottom=o):(r.top=o,r.bottom="auto")),n.autoMinWidth||(r.minWidth=a),t.css(r),e}}function l(e,t){var n,i,a;if(-1===t.indexId&&!t.idField||t.multiWord)return e;i=t.inputBgColor,a=t.inputWarnColor;var r=e.val(),l=e.data("pre-val");return o(e)||!r?(e.css("background",i||""),!r&&l&&e.trigger("onUnsetSelectValue").data("pre-val",""),e):(n=e.css("backgroundColor").replace(/ /g,"").split(",",3).join(","),~a.indexOf(n)||e.trigger("onUnsetSelectValue").data("pre-val","").css("background",a),e)}function s(e,t,n){var i,o,a=e.parent().find("tbody tr."+n.listHoverCSS);a.length&&((i=(a.index()+3)*a.height())>(o=+t.css("maxHeight").replace("px",""))||t.scrollTop()>o?i-=o:i=0,t.scrollTop(i))}function u(e,t){e.find("tr."+t.listHoverCSS).removeClass(t.listHoverCSS)}function d(e,t,n){return!t.length||e.data(j)?A:(e.data(j,{options:n}),D)}function f(e){var n,i=D;for(n in e)if("value"===n){i=A;break}return i?(t("返回数据格式错误!"),A):e.value.length?e:A}function c(t,n){var i=n.effectiveFields;return!("__index"===t||i.length&&!~e.inArray(t,i))}function p(t,n){return~e.inArray(t,n.searchFields)}function h(e,t,n,i){n.html('<div style="padding:10px 5px 5px">'+e+"</div>").show(),r(t,n,i)}function v(e,t,n){var i,o,a,l,s,u,d=e.parent().find("ul:eq(0)"),f=0,p=['<table class="table table-condensed table-sm" style="margin:0">'],v=t.value;if(!t||!(i=v.length))return n.emptyTip?h(n.emptyTip,e,d,n):d.empty().hide(),e;if(n._lastData&&JSON.stringify(n._lastData)===JSON.stringify(t)&&d.find("tr").length===i)return d.show(),r(e,d,n);if(n._lastData=t,n.showHeader){p.push("<thead><tr>");for(a in v[0])c(a,n)&&(p.push("<th>",n.effectiveFieldsAlias[a]||a,0===f?"("+i+")":"","</th>"),f++);p.push("</tr></thead>")}p.push("<tbody>");var y;for(o=0;o<i;o++){f=0,l=[],s=(y=v[o])[n.idField]||"",u=y[n.keyField]||"";for(a in y)u||n.indexKey!==f||(u=y[a]),s||n.indexId!==f||(s=y[a]),f++,c(a,n)&&l.push('<td data-name="',a,'">',y[a],"</td>");p.push('<tr data-index="',y.__index||o,'" data-id="',s,'" data-key="',u,'">',l.join(""),"</tr>")}return p.push("</tbody></table>"),d.html(p.join("")).show(),setTimeout(function(){if(!S){var e=d.find("table:eq(0)"),t=0,n=0;d.height()<e.height()&&+d.css("minWidth").replace("px","")<d.width()&&(t=18,n=20),d.css("paddingRight",t),e.css("marginBottom",n)}},301),r(e,d,n),e}function y(t,n){n=n||"";var i=t._preAjax;i&&i.abort&&4!==i.readyState&&i.abort();var o={type:"GET",dataType:t.jsonp?"jsonp":"json",timeout:5e3};t.jsonp&&(o.jsonp=t.jsonp);var a,r=t.fnAdjustAjaxParam;if(e.isFunction(r)){if(a=r(n,t),A===a)return;e.extend(o,a)}return o.url=function(){if(!n||o.data)return o.url||t.url;var e="?";return/=$/.test(t.url)?e="":/\?/.test(t.url)&&(e="&"),t.url+e+encodeURIComponent(n)}(),t._preAjax=e.ajax(o).done(function(e){t.data=t.fnProcessData(e)}).fail(function(e){t.fnAjaxFail&&t.fnAjaxFail(e,t)})}function g(t,n,i,o){return i=e.trim(i),o.ignorecase&&(t=t.toLocaleLowerCase(),i=i.toLocaleLowerCase()),i&&(c(n,o)||p(n,o))&&(~i.indexOf(t)||o.twoWayMatch&&~t.indexOf(i))}function m(t,n){var i=t.prev("i.clearable");return n.clearable&&!i.length&&(i=e('<i class="clearable glyphicon glyphicon-remove"></i>').prependTo(t.parent())),i.css({position:"absolute",top:12,right:n.showBtn?(t.next(".input-group-btn").width()||33)+2:12,zIndex:4,cursor:"pointer",fontSize:12}).hide()}var b,w=e(window),x="ActiveXObject"in window,k=navigator.userAgent.match(/Chrome\/(\d+)/);k&&(k=+k[1]);var S=x||k>51,j="bsSuggest",C="onDataRequestSuccess",D=!0,A=!1,F={url:null,jsonp:null,data:{value:[]},indexId:0,indexKey:0,idField:"",keyField:"",autoSelect:D,allowNoKeyword:D,getDataMethod:"firstByUrl",delayUntilKeyup:A,ignorecase:A,effectiveFields:[],effectiveFieldsAlias:{},searchFields:[],twoWayMatch:D,multiWord:A,separator:",",delay:300,emptyTip:"",searchingTip:"搜索中...",autoDropup:A,autoMinWidth:A,showHeader:A,showBtn:D,inputBgColor:"",inputWarnColor:"rgba(255,0,0,.1)",listStyle:{"padding-top":0,"max-height":"375px","max-width":"800px",overflow:"auto",width:"auto",transition:"0.3s","-webkit-transition":"0.3s","-moz-transition":"0.3s","-o-transition":"0.3s"},listAlign:"left",listHoverStyle:"background: #07d; color:#fff",listHoverCSS:"jhover",clearable:A,keyLeft:37,keyUp:38,keyRight:39,keyDown:40,keyEnter:13,fnProcessData:function(e){return f(e)},fnGetData:function(t,n,i,o){var a,r,l,s,u={value:[]},d=o.fnPreprocessKeyword;if(t=t||"",e.isFunction(d)&&(t=d(t,o)),o.url){var c;o.searchingTip&&(c=setTimeout(function(){h(o.searchingTip,n,n.parent().find("ul"),o)},600)),y(o,t).done(function(e){i(n,o.data,o),n.trigger(C,e),"firstByUrl"===o.getDataMethod&&(o.url=null)}).always(function(){c&&clearTimeout(c)})}else{if(a=o.data,f(a))if(t){for(s=a.value.length,r=0;r<s;r++)for(l in a.value[r])if(a.value[r][l]&&g(t,l,a.value[r][l]+"",o)){u.value.push(a.value[r]),u.value[u.value.length-1].__index=r;break}}else u=a;i(n,u,o)}},fnAdjustAjaxParam:null,fnPreprocessKeyword:null,fnAjaxFail:null},T={init:function(t){var f=this;return void 0===(t=t||{}).showHeader&&t.effectiveFields&&t.effectiveFields.length>1&&(t.showHeader=D),(t=e.extend(D,{},F,t)).processData&&(t.fnProcessData=t.processData),t.getData&&(t.fnGetData=t.getData),"firstByUrl"===t.getDataMethod&&t.url&&!t.delayUntilKeyup&&y(t).done(function(e){t.url=null,f.trigger(C,e)}),e("#"+j).length||e("head:eq(0)").append('<style id="'+j+'">.'+t.listHoverCSS+"{"+t.listHoverStyle+"}</style>"),f.each(function(){var f,c,p=e(this),h=p.parent(),y=m(p,t),g=h.find("ul:eq(0)");d(p,g,t)&&(t.showBtn||(p.css("borderRadius",4),h.css("width","100%").find(".btn:eq(0)").hide()),p.removeClass("disabled").prop("disabled",A).attr("autocomplete","off"),g.css(t.listStyle),t.inputBgColor||(t.inputBgColor=p.css("backgroundColor")),p.on("keydown",function(e){var r,l;if(g.is(":visible")){if(r=g.find("."+t.listHoverCSS),l="",u(g,t),e.keyCode===t.keyDown){if(r.length?r.next().length?l=n(r.next().mouseover()):t.autoSelect&&o(p,"").val(i(p)):l=n(g.find("tbody tr:first").mouseover()),s(p,g,t),!t.autoSelect)return}else if(e.keyCode===t.keyUp){if(r.length?r.prev().length?l=n(r.prev().mouseover()):t.autoSelect&&o(p,"").val(i(p)):l=n(g.find("tbody tr:last").mouseover()),s(p,g,t),!t.autoSelect)return}else e.keyCode===t.keyEnter?(l=n(r),g.hide()):o(p,"");a(p,l,t)}else o(p,"")}).on("compositionstart",function(e){b=D}).on("compositionend",function(e){b=A}).on("keyup input paste",function(n){var o;n.keyCode&&l(p,t),~e.inArray(n.keyCode,[t.keyDown,t.keyUp,t.keyEnter])?p.val(p.val()):(clearTimeout(c),c=setTimeout(function(){b||(o=p.val(),e.trim(o)&&o===i(p)||(i(p,o),t.multiWord&&(o=o.split(t.separator).reverse()[0]),(o.length||t.allowNoKeyword)&&t.fnGetData(e.trim(o),p,v,t)))},t.delay||300))}).on("focus",function(){r(p,g,t)}).on("blur",function(){f||g.css("display","")}).on("click",function(){var n=p.val();if(e.trim(n)&&n===i(p)&&g.find("table tr").length)return g.show();g.is(":visible")||(t.multiWord&&(n=n.split(t.separator).reverse()[0]),(n.length||t.allowNoKeyword)&&t.fnGetData(e.trim(n),p,v,t))}),h.find(".btn:eq(0)").attr("data-toggle","").click(function(){var e="none";return g.css("display")===e&&(e="block",t.url?(p.click().focus(),g.find("tr").length||(e="none")):v(p,t.data,t)),g.css("display",e),A}),g.mouseenter(function(){f=1,p.blur()}).mouseleave(function(){f=0,p.focus()}).on("mouseenter","tbody tr",function(){return u(g,t),e(this).addClass(t.listHoverCSS),A}).on("mousedown","tbody tr",function(){var o=n(e(this));a(p,o,t),i(p,o.key),l(p,t),g.hide()}),y.length&&(y.click(function(){o(p,"").val(""),l(p,t)}),h.mouseenter(function(){p.prop("disabled")||y.show()}).mouseleave(function(){y.hide()})))})},show:function(){return this.each(function(){e(this).click()})},hide:function(){return this.each(function(){e(this).parent().find("ul:eq(0)").css("display","")})},disable:function(){return this.each(function(){e(this).attr("disabled",D).parent().find(".btn:eq(0)").prop("disabled",D)})},enable:function(){return this.each(function(){e(this).attr("disabled",A).parent().find(".btn:eq(0)").prop("disabled",A)})},destroy:function(){return this.each(function(){e(this).off().removeData(j).removeAttr("style").parent().find(".btn:eq(0)").off().show().attr("data-toggle","dropdown").prop("disabled",A).next().css("display","").off()})},version:function(){return"0.1.23"}};e.fn[j]=function(t){if("string"==typeof t&&T[t]){var n=D;return this.each(function(){if(!e(this).data(j))return n=A}),n||"init"===t||"version"===t?T[t].apply(this,[].slice.call(arguments,1)):this}return T.init.apply(this,arguments)}});
//# sourceMappingURL=bootstrap-suggest.min.js.map